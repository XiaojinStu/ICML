{
  "summary": {
    "method": "steps0_mlp_last",
    "algo": "ane_tta",
    "task": "gsm8k",
    "eval_mode": "ar",
    "tta_reset": "sample",
    "model": "Llama-3.2-3B-Instruct",
    "steps": 0,
    "lr": 0.001,
    "update_target": "mlp",
    "num_layers": "1",
    "layer_stride": 1,
    "optimizer": "sgd",
    "momentum": 0.0,
    "token_total": 3,
    "token_correct_before": 0,
    "token_correct_after": 0,
    "token_acc_before": 0.0,
    "token_acc_after": 0.0,
    "token_topk_correct_before": {
      "5": 0
    },
    "token_topk_correct_after": {
      "5": 0
    },
    "token_topk_acc_before": {
      "5": 0.0
    },
    "token_topk_acc_after": {
      "5": 0.0
    },
    "seq_total": 3,
    "seq_correct_before": 0,
    "seq_correct_after": 0,
    "seq_acc_before": 0.0,
    "seq_acc_after": 0.0,
    "str_total": 3,
    "str_correct_before": 0,
    "str_correct_after": 0,
    "str_acc_before": 0.0,
    "str_acc_after": 0.0,
    "flipped_count": 0,
    "elapsed_minutes": 0.02645008166631063,
    "trainable": {
      "trainable_params": 75497472,
      "trainable_pct": 2.349933114493262,
      "layer_count": 1,
      "total_layers": 28
    }
  },
  "results": [
    {
      "id": "gsm8k-test-1155",
      "question": "John buys a cassette with 2 songs.  The first song is 5 minutes and the second song is 60% longer.  How much time was the total cassette?",
      "answer": "13",
      "eval_mode": "ar",
      "pred_before_str": "7",
      "pred_after_str": "7",
      "correct_before_str": false,
      "correct_after_str": false,
      "tokens": [
        {
          "position": 0,
          "answer_len": 1,
          "target_id": 1032,
          "target_token": "13",
          "pred_before_id": 22,
          "pred_before": "7",
          "pred_after_id": 22,
          "pred_after": "7",
          "correct_before": false,
          "correct_after": false,
          "rank_before": 13,
          "rank_after": 13,
          "prob_before": 0.011678959242999554,
          "prob_after": 0.011678959242999554,
          "metrics": {
            "loss": [
              0.8896303772926331
            ],
            "target_prob": [
              0.011678959242999554
            ],
            "target_rank": [
              13
            ],
            "num_topk_probs": [
              [
                0.2658120095729828,
                0.1612231284379959,
                0.0977867841720581,
                0.08629652112722397,
                0.031746719032526016,
                0.028016379103064537,
                0.024724368005990982,
                0.021819178014993668,
                0.01925535872578621,
                0.01925535872578621
              ]
            ],
            "num_topk_snapshots": [
              {
                "step": 0,
                "topk": [
                  {
                    "idx": 22,
                    "prob": 0.2658120095729828
                  },
                  {
                    "idx": 806,
                    "prob": 0.1612231284379959
                  },
                  {
                    "idx": 914,
                    "prob": 0.0977867841720581
                  },
                  {
                    "idx": 1114,
                    "prob": 0.08629652112722397
                  },
                  {
                    "idx": 605,
                    "prob": 0.031746719032526016
                  },
                  {
                    "idx": 5313,
                    "prob": 0.028016379103064537
                  },
                  {
                    "idx": 23,
                    "prob": 0.024724368005990982
                  },
                  {
                    "idx": 20,
                    "prob": 0.021819178014993668
                  },
                  {
                    "idx": 2397,
                    "prob": 0.01925535872578621
                  },
                  {
                    "idx": 6549,
                    "prob": 0.01925535872578621
                  }
                ]
              }
            ],
            "status": [
              "baseline"
            ]
          }
        }
      ]
    },
    {
      "id": "gsm8k-test-1283",
      "question": "Frances sells 20 cupcakes for $2 for each cupcake and  40  cookies at $1 each.  She buys five trays at $4 for each tray. How much money does Frances have left?",
      "answer": "60",
      "eval_mode": "ar",
      "pred_before_str": "140",
      "pred_after_str": "140",
      "correct_before_str": false,
      "correct_after_str": false,
      "tokens": [
        {
          "position": 0,
          "answer_len": 1,
          "target_id": 1399,
          "target_token": "60",
          "pred_before_id": 6860,
          "pred_before": "140",
          "pred_after_id": 6860,
          "pred_after": "140",
          "correct_before": false,
          "correct_after": false,
          "rank_before": 7,
          "rank_after": 7,
          "prob_before": 0.04300304129719734,
          "prob_after": 0.04300304129719734,
          "metrics": {
            "loss": [
              1.0365610122680664
            ],
            "target_prob": [
              0.04300304129719734
            ],
            "target_rank": [
              7
            ],
            "num_topk_probs": [
              [
                0.11689449846744537,
                0.09103752672672272,
                0.06256911903619766,
                0.06256911903619766,
                0.06256911903619766,
                0.06256911903619766,
                0.04300308600068092,
                0.03349083289504051,
                0.026082688942551613,
                0.026082688942551613
              ]
            ],
            "num_topk_snapshots": [
              {
                "step": 0,
                "topk": [
                  {
                    "idx": 6860,
                    "prob": 0.11689449846744537
                  },
                  {
                    "idx": 8273,
                    "prob": 0.09103752672672272
                  },
                  {
                    "idx": 4364,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 6330,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1041,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1490,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1399,
                    "prob": 0.04300308600068092
                  },
                  {
                    "idx": 1049,
                    "prob": 0.03349083289504051
                  },
                  {
                    "idx": 3965,
                    "prob": 0.026082688942551613
                  },
                  {
                    "idx": 8610,
                    "prob": 0.026082688942551613
                  }
                ]
              }
            ],
            "status": [
              "baseline"
            ]
          }
        }
      ]
    },
    {
      "id": "gsm8k-test-387",
      "question": "An eraser costs $2 and a pencil costs $3. How much do 6 erasers and 8 pencils cost?",
      "answer": "36",
      "eval_mode": "ar",
      "pred_before_str": "24",
      "pred_after_str": "24",
      "correct_before_str": false,
      "correct_after_str": false,
      "tokens": [
        {
          "position": 0,
          "answer_len": 1,
          "target_id": 1927,
          "target_token": "36",
          "pred_before_id": 1187,
          "pred_before": "24",
          "pred_after_id": 1187,
          "pred_after": "24",
          "correct_before": false,
          "correct_after": false,
          "rank_before": 28,
          "rank_after": 28,
          "prob_before": 0.0006021368899382651,
          "prob_after": 0.0006021368899382651,
          "metrics": {
            "loss": [
              0.734981119632721
            ],
            "target_prob": [
              0.0006021368899382651
            ],
            "target_rank": [
              28
            ],
            "num_topk_probs": [
              [
                0.2752637565135956,
                0.2429194152355194,
                0.10126388818025589,
                0.10126388818025589,
                0.08936505764722824,
                0.04783366620540619,
                0.042213067412376404,
                0.017597023397684097,
                0.012094245292246342,
                0.012094245292246342
              ]
            ],
            "num_topk_snapshots": [
              {
                "step": 0,
                "topk": [
                  {
                    "idx": 1187,
                    "prob": 0.2752637565135956
                  },
                  {
                    "idx": 508,
                    "prob": 0.2429194152355194
                  },
                  {
                    "idx": 845,
                    "prob": 0.10126388818025589
                  },
                  {
                    "idx": 975,
                    "prob": 0.10126388818025589
                  },
                  {
                    "idx": 972,
                    "prob": 0.08936505764722824
                  },
                  {
                    "idx": 717,
                    "prob": 0.04783366620540619
                  },
                  {
                    "idx": 1313,
                    "prob": 0.042213067412376404
                  },
                  {
                    "idx": 1627,
                    "prob": 0.017597023397684097
                  },
                  {
                    "idx": 17,
                    "prob": 0.012094245292246342
                  },
                  {
                    "idx": 777,
                    "prob": 0.012094245292246342
                  }
                ]
              }
            ],
            "status": [
              "baseline"
            ]
          }
        }
      ]
    }
  ],
  "flipped_cases": []
}