{
  "summary": {
    "method": "steps1_mlp_last",
    "algo": "ane_tta",
    "task": "gsm8k",
    "eval_mode": "ar",
    "tta_reset": "sample",
    "model": "Llama-3.2-3B-Instruct",
    "steps": 1,
    "lr": 0.001,
    "update_target": "mlp",
    "num_layers": "1",
    "layer_stride": 1,
    "optimizer": "sgd",
    "momentum": 0.0,
    "token_total": 2,
    "token_correct_before": 0,
    "token_correct_after": 0,
    "token_acc_before": 0.0,
    "token_acc_after": 0.0,
    "token_topk_correct_before": {
      "5": 0
    },
    "token_topk_correct_after": {
      "5": 0
    },
    "token_topk_acc_before": {
      "5": 0.0
    },
    "token_topk_acc_after": {
      "5": 0.0
    },
    "seq_total": 2,
    "seq_correct_before": 0,
    "seq_correct_after": 0,
    "seq_acc_before": 0.0,
    "seq_acc_after": 0.0,
    "str_total": 2,
    "str_correct_before": 0,
    "str_correct_after": 0,
    "str_acc_before": 0.0,
    "str_acc_after": 0.0,
    "flipped_count": 0,
    "elapsed_minutes": 0.020769691467285155,
    "trainable": {
      "trainable_params": 75497472,
      "trainable_pct": 2.349933114493262,
      "layer_count": 1,
      "total_layers": 28
    }
  },
  "results": [
    {
      "id": "gsm8k-test-1155",
      "question": "John buys a cassette with 2 songs.  The first song is 5 minutes and the second song is 60% longer.  How much time was the total cassette?",
      "answer": "13",
      "eval_mode": "ar",
      "pred_before_str": "7",
      "pred_after_str": "7",
      "correct_before_str": false,
      "correct_after_str": false,
      "tokens": [
        {
          "position": 0,
          "answer_len": 1,
          "target_id": 1032,
          "target_token": "13",
          "pred_before_id": 22,
          "pred_before": "7",
          "pred_after_id": 22,
          "pred_after": "7",
          "correct_before": false,
          "correct_after": false,
          "rank_before": 13,
          "rank_after": 13,
          "prob_before": 0.011678959242999554,
          "prob_after": 0.011679650284349918,
          "metrics": {
            "loss": [
              0.8896303772926331,
              0.8896303772926331
            ],
            "target_prob": [
              0.011678959242999554,
              0.011679650284349918
            ],
            "target_rank": [
              13,
              13
            ],
            "num_topk_probs": [
              [
                0.2658120095729828,
                0.1612231284379959,
                0.0977867841720581,
                0.08629652112722397,
                0.031746719032526016,
                0.028016379103064537,
                0.024724368005990982,
                0.021819178014993668,
                0.01925535872578621,
                0.01925535872578621
              ],
              [
                0.26582780480384827,
                0.16123272478580475,
                0.0977925956249237,
                0.08630165457725525,
                0.03174860402941704,
                0.02801804430782795,
                0.024725837633013725,
                0.021820474416017532,
                0.019256502389907837,
                0.019256502389907837
              ]
            ],
            "num_topk_snapshots": [
              {
                "step": 0,
                "topk": [
                  {
                    "idx": 22,
                    "prob": 0.2658120095729828
                  },
                  {
                    "idx": 806,
                    "prob": 0.1612231284379959
                  },
                  {
                    "idx": 914,
                    "prob": 0.0977867841720581
                  },
                  {
                    "idx": 1114,
                    "prob": 0.08629652112722397
                  },
                  {
                    "idx": 605,
                    "prob": 0.031746719032526016
                  },
                  {
                    "idx": 5313,
                    "prob": 0.028016379103064537
                  },
                  {
                    "idx": 23,
                    "prob": 0.024724368005990982
                  },
                  {
                    "idx": 20,
                    "prob": 0.021819178014993668
                  },
                  {
                    "idx": 2397,
                    "prob": 0.01925535872578621
                  },
                  {
                    "idx": 6549,
                    "prob": 0.01925535872578621
                  }
                ]
              },
              {
                "step": 1,
                "topk": [
                  {
                    "idx": 22,
                    "prob": 0.26582780480384827
                  },
                  {
                    "idx": 806,
                    "prob": 0.16123272478580475
                  },
                  {
                    "idx": 914,
                    "prob": 0.0977925956249237
                  },
                  {
                    "idx": 1114,
                    "prob": 0.08630165457725525
                  },
                  {
                    "idx": 605,
                    "prob": 0.03174860402941704
                  },
                  {
                    "idx": 5313,
                    "prob": 0.02801804430782795
                  },
                  {
                    "idx": 23,
                    "prob": 0.024725837633013725
                  },
                  {
                    "idx": 20,
                    "prob": 0.021820474416017532
                  },
                  {
                    "idx": 2397,
                    "prob": 0.019256502389907837
                  },
                  {
                    "idx": 6549,
                    "prob": 0.019256502389907837
                  }
                ]
              }
            ],
            "status": [
              "baseline",
              "ok"
            ]
          }
        }
      ]
    },
    {
      "id": "gsm8k-test-1283",
      "question": "Frances sells 20 cupcakes for $2 for each cupcake and  40  cookies at $1 each.  She buys five trays at $4 for each tray. How much money does Frances have left?",
      "answer": "60",
      "eval_mode": "ar",
      "pred_before_str": "140",
      "pred_after_str": "140",
      "correct_before_str": false,
      "correct_after_str": false,
      "tokens": [
        {
          "position": 0,
          "answer_len": 1,
          "target_id": 1399,
          "target_token": "60",
          "pred_before_id": 6860,
          "pred_before": "140",
          "pred_after_id": 6860,
          "pred_after": "140",
          "correct_before": false,
          "correct_after": false,
          "rank_before": 7,
          "rank_after": 7,
          "prob_before": 0.04300304129719734,
          "prob_after": 0.04300533980131149,
          "metrics": {
            "loss": [
              1.0365610122680664,
              1.0365610122680664
            ],
            "target_prob": [
              0.04300304129719734,
              0.04300533980131149
            ],
            "target_rank": [
              7,
              7
            ],
            "num_topk_probs": [
              [
                0.11689449846744537,
                0.09103752672672272,
                0.06256911903619766,
                0.06256911903619766,
                0.06256911903619766,
                0.06256911903619766,
                0.04300308600068092,
                0.03349083289504051,
                0.026082688942551613,
                0.026082688942551613
              ],
              [
                0.11690059304237366,
                0.09104227274656296,
                0.06257238239049911,
                0.06257238239049911,
                0.06257238239049911,
                0.06257238239049911,
                0.0430053286254406,
                0.03349258005619049,
                0.02608404867351055,
                0.02608404867351055
              ]
            ],
            "num_topk_snapshots": [
              {
                "step": 0,
                "topk": [
                  {
                    "idx": 6860,
                    "prob": 0.11689449846744537
                  },
                  {
                    "idx": 8273,
                    "prob": 0.09103752672672272
                  },
                  {
                    "idx": 4364,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 6330,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1041,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1490,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1399,
                    "prob": 0.04300308600068092
                  },
                  {
                    "idx": 1049,
                    "prob": 0.03349083289504051
                  },
                  {
                    "idx": 3965,
                    "prob": 0.026082688942551613
                  },
                  {
                    "idx": 8610,
                    "prob": 0.026082688942551613
                  }
                ]
              },
              {
                "step": 1,
                "topk": [
                  {
                    "idx": 6860,
                    "prob": 0.11690059304237366
                  },
                  {
                    "idx": 8273,
                    "prob": 0.09104227274656296
                  },
                  {
                    "idx": 4364,
                    "prob": 0.06257238239049911
                  },
                  {
                    "idx": 6330,
                    "prob": 0.06257238239049911
                  },
                  {
                    "idx": 1041,
                    "prob": 0.06257238239049911
                  },
                  {
                    "idx": 1490,
                    "prob": 0.06257238239049911
                  },
                  {
                    "idx": 1399,
                    "prob": 0.0430053286254406
                  },
                  {
                    "idx": 1049,
                    "prob": 0.03349258005619049
                  },
                  {
                    "idx": 3965,
                    "prob": 0.02608404867351055
                  },
                  {
                    "idx": 8610,
                    "prob": 0.02608404867351055
                  }
                ]
              }
            ],
            "status": [
              "baseline",
              "ok"
            ]
          }
        }
      ]
    }
  ],
  "flipped_cases": []
}