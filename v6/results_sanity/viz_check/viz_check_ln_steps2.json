{
  "summary": {
    "method": "viz_check_ln_steps2",
    "algo": "ane_tta",
    "task": "gsm8k",
    "eval_mode": "ar",
    "tta_reset": "sample",
    "model": "Llama-3.2-3B-Instruct",
    "steps": 2,
    "lr": 0.001,
    "update_target": "ln",
    "num_layers": "all",
    "layer_stride": 1,
    "optimizer": "sgd",
    "momentum": 0.0,
    "token_total": 2,
    "token_correct_before": 0,
    "token_correct_after": 0,
    "token_acc_before": 0.0,
    "token_acc_after": 0.0,
    "token_topk_correct_before": {
      "5": 0
    },
    "token_topk_correct_after": {
      "5": 0
    },
    "token_topk_acc_before": {
      "5": 0.0
    },
    "token_topk_acc_after": {
      "5": 0.0
    },
    "seq_total": 2,
    "seq_correct_before": 0,
    "seq_correct_after": 0,
    "seq_acc_before": 0.0,
    "seq_acc_after": 0.0,
    "str_total": 2,
    "str_correct_before": 0,
    "str_correct_after": 0,
    "str_acc_before": 0.0,
    "str_acc_after": 0.0,
    "flipped_count": 0,
    "elapsed_minutes": 0.02673787275950114,
    "trainable": {
      "trainable_params": 172032,
      "trainable_pct": 0.005354665299952095,
      "layer_count": 28,
      "total_layers": 28
    }
  },
  "results": [
    {
      "id": "gsm8k-test-1155",
      "question": "John buys a cassette with 2 songs.  The first song is 5 minutes and the second song is 60% longer.  How much time was the total cassette?",
      "answer": "13",
      "eval_mode": "ar",
      "pred_before_str": "7",
      "pred_after_str": "7",
      "correct_before_str": false,
      "correct_after_str": false,
      "tokens": [
        {
          "position": 0,
          "answer_len": 1,
          "target_id": 1032,
          "target_token": "13",
          "pred_before_id": 22,
          "pred_before": "7",
          "pred_after_id": 22,
          "pred_after": "7",
          "correct_before": false,
          "correct_after": false,
          "rank_before": 13,
          "rank_after": 14,
          "prob_before": 0.011678959242999554,
          "prob_after": 0.011067544110119343,
          "metrics": {
            "loss": [
              0.8896303772926331,
              0.8896303772926331,
              0.9024139046669006
            ],
            "target_prob": [
              0.011678959242999554,
              0.010940439067780972,
              0.011067544110119343
            ],
            "target_rank": [
              13,
              13,
              14
            ],
            "num_topk_probs": [
              [
                0.2658120095729828,
                0.1612231284379959,
                0.0977867841720581,
                0.08629652112722397,
                0.031746719032526016,
                0.028016379103064537,
                0.024724368005990982,
                0.021819178014993668,
                0.01925535872578621,
                0.01925535872578621
              ],
              [
                0.24900317192077637,
                0.17113721370697021,
                0.09160315990447998,
                0.08083949238061905,
                0.0336989127099514,
                0.0336989127099514,
                0.0231609009206295,
                0.0231609009206295,
                0.020439425483345985,
                0.020439425483345985
              ],
              [
                0.25189605355262756,
                0.1731254607439041,
                0.09266738593578339,
                0.08177867531776428,
                0.034090422093868256,
                0.030084693804383278,
                0.023429982364177704,
                0.020676886662840843,
                0.020676886662840843,
                0.018247289583086967
              ]
            ],
            "num_topk_snapshots": [
              {
                "step": 0,
                "topk": [
                  {
                    "idx": 22,
                    "prob": 0.2658120095729828
                  },
                  {
                    "idx": 806,
                    "prob": 0.1612231284379959
                  },
                  {
                    "idx": 914,
                    "prob": 0.0977867841720581
                  },
                  {
                    "idx": 1114,
                    "prob": 0.08629652112722397
                  },
                  {
                    "idx": 605,
                    "prob": 0.031746719032526016
                  },
                  {
                    "idx": 5313,
                    "prob": 0.028016379103064537
                  },
                  {
                    "idx": 23,
                    "prob": 0.024724368005990982
                  },
                  {
                    "idx": 20,
                    "prob": 0.021819178014993668
                  },
                  {
                    "idx": 2397,
                    "prob": 0.01925535872578621
                  },
                  {
                    "idx": 6549,
                    "prob": 0.01925535872578621
                  }
                ]
              },
              {
                "step": 2,
                "topk": [
                  {
                    "idx": 22,
                    "prob": 0.25189605355262756
                  },
                  {
                    "idx": 806,
                    "prob": 0.1731254607439041
                  },
                  {
                    "idx": 914,
                    "prob": 0.09266738593578339
                  },
                  {
                    "idx": 1114,
                    "prob": 0.08177867531776428
                  },
                  {
                    "idx": 605,
                    "prob": 0.034090422093868256
                  },
                  {
                    "idx": 5313,
                    "prob": 0.030084693804383278
                  },
                  {
                    "idx": 23,
                    "prob": 0.023429982364177704
                  },
                  {
                    "idx": 20,
                    "prob": 0.020676886662840843
                  },
                  {
                    "idx": 2397,
                    "prob": 0.020676886662840843
                  },
                  {
                    "idx": 6549,
                    "prob": 0.018247289583086967
                  }
                ]
              }
            ],
            "status": [
              "baseline",
              "ok",
              "ok"
            ]
          }
        }
      ]
    },
    {
      "id": "gsm8k-test-1283",
      "question": "Frances sells 20 cupcakes for $2 for each cupcake and  40  cookies at $1 each.  She buys five trays at $4 for each tray. How much money does Frances have left?",
      "answer": "60",
      "eval_mode": "ar",
      "pred_before_str": "140",
      "pred_after_str": "140",
      "correct_before_str": false,
      "correct_after_str": false,
      "tokens": [
        {
          "position": 0,
          "answer_len": 1,
          "target_id": 1399,
          "target_token": "60",
          "pred_before_id": 6860,
          "pred_before": "140",
          "pred_after_id": 6860,
          "pred_after": "140",
          "correct_before": false,
          "correct_after": false,
          "rank_before": 7,
          "rank_after": 7,
          "prob_before": 0.04300304129719734,
          "prob_after": 0.03909263387322426,
          "metrics": {
            "loss": [
              1.0365610122680664,
              1.0365610122680664,
              1.0358747243881226
            ],
            "target_prob": [
              0.04300304129719734,
              0.04337819665670395,
              0.03909263387322426
            ],
            "target_rank": [
              7,
              7,
              7
            ],
            "num_topk_probs": [
              [
                0.11689449846744537,
                0.09103752672672272,
                0.06256911903619766,
                0.06256911903619766,
                0.06256911903619766,
                0.06256911903619766,
                0.04300308600068092,
                0.03349083289504051,
                0.026082688942551613,
                0.026082688942551613
              ],
              [
                0.1179140955209732,
                0.09183159470558167,
                0.06311487406492233,
                0.06311487406492233,
                0.06311487406492233,
                0.06311487406492233,
                0.04337817803025246,
                0.0337829552590847,
                0.026310192421078682,
                0.023218661546707153
              ],
              [
                0.12041382491588593,
                0.09377837926149368,
                0.0644528791308403,
                0.0644528791308403,
                0.0644528791308403,
                0.0644528791308403,
                0.039092645049095154,
                0.034499138593673706,
                0.023710886016488075,
                0.023710886016488075
              ]
            ],
            "num_topk_snapshots": [
              {
                "step": 0,
                "topk": [
                  {
                    "idx": 6860,
                    "prob": 0.11689449846744537
                  },
                  {
                    "idx": 8273,
                    "prob": 0.09103752672672272
                  },
                  {
                    "idx": 4364,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 6330,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1041,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1490,
                    "prob": 0.06256911903619766
                  },
                  {
                    "idx": 1399,
                    "prob": 0.04300308600068092
                  },
                  {
                    "idx": 1049,
                    "prob": 0.03349083289504051
                  },
                  {
                    "idx": 3965,
                    "prob": 0.026082688942551613
                  },
                  {
                    "idx": 8610,
                    "prob": 0.026082688942551613
                  }
                ]
              },
              {
                "step": 2,
                "topk": [
                  {
                    "idx": 6860,
                    "prob": 0.12041382491588593
                  },
                  {
                    "idx": 8273,
                    "prob": 0.09377837926149368
                  },
                  {
                    "idx": 4364,
                    "prob": 0.0644528791308403
                  },
                  {
                    "idx": 6330,
                    "prob": 0.0644528791308403
                  },
                  {
                    "idx": 1041,
                    "prob": 0.0644528791308403
                  },
                  {
                    "idx": 1490,
                    "prob": 0.0644528791308403
                  },
                  {
                    "idx": 1399,
                    "prob": 0.039092645049095154
                  },
                  {
                    "idx": 1049,
                    "prob": 0.034499138593673706
                  },
                  {
                    "idx": 3965,
                    "prob": 0.023710886016488075
                  },
                  {
                    "idx": 8610,
                    "prob": 0.023710886016488075
                  }
                ]
              }
            ],
            "status": [
              "baseline",
              "ok",
              "ok"
            ]
          }
        }
      ]
    }
  ],
  "flipped_cases": []
}