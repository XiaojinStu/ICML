{
  "summary": {
    "model": "Llama-3.2-3B-Instruct",
    "accuracy_before": 1.0,
    "accuracy_after": 1.0,
    "improvement": 0.0,
    "total_tokens": 2,
    "flipped_count": 0,
    "elapsed_time_min": 0.5661752144495646,
    "config": {
      "models": [
        "/home/jinsk/Models/Llama-3.2-3B-Instruct"
      ],
      "data_path": "../data/addition_problems_dataset(1-50)(1).json",
      "num_samples": 2,
      "update_target": "attn+ln",
      "num_layers": "all",
      "steps": 5,
      "lr": 0.0005,
      "optimizer": "sgd",
      "scheduler": null,
      "gradient_checkpointing": false
    }
  },
  "results": [
    {
      "question": "What is the sum of 9 and 8?",
      "answer": 17,
      "tokens": [
        {
          "position": 0,
          "target": 1114,
          "target_token": "17",
          "pred_before": "17",
          "pred_after": "17",
          "correct_before": true,
          "correct_after": true,
          "metrics": {
            "nae": [
              0.014209581539034843,
              0.014217575080692768,
              0.014210974797606468,
              0.014209605753421783,
              0.014213609509170055,
              0.0
            ],
            "target_prob": [
              0.9999356269836426,
              0.9999277591705322,
              0.999934196472168,
              0.9999357461929321,
              0.9999310970306396,
              0.9999330043792725
            ],
            "target_rank": [
              1,
              1,
              1,
              1,
              1,
              1
            ],
            "top10_probs": [
              [
                0.9999356269836426,
                2.753467924776487e-05,
                4.222579264023807e-06,
                3.2885482141864486e-06,
                3.2885482141864486e-06,
                2.56112389251939e-06,
                1.7602329762667068e-06,
                1.0676352530936128e-06,
                1.0676352530936128e-06,
                1.0029505119746318e-06
              ],
              [
                0.9999277591705322,
                3.120063047390431e-05,
                4.222546067467192e-06,
                3.726383965840796e-06,
                3.288522293587448e-06,
                2.90211096398707e-06,
                1.9945896383433137e-06,
                1.2878039115093998e-06,
                1.136482978836284e-06,
                1.136482978836284e-06
              ],
              [
                0.999934196472168,
                2.7534639229997993e-05,
                4.222573352308245e-06,
                3.2885434393392643e-06,
                3.2885434393392643e-06,
                2.561120254540583e-06,
                1.994602598642814e-06,
                1.1364902547938982e-06,
                1.1364902547938982e-06,
                1.0676337751647225e-06
              ],
              [
                0.9999357461929321,
                2.7534681066754274e-05,
                4.222579718771158e-06,
                3.2885486689337995e-06,
                3.2885486689337995e-06,
                2.5611241198930657e-06,
                1.7602332036403823e-06,
                1.0676354804672883e-06,
                1.0676354804672883e-06,
                1.0029506256614695e-06
              ],
              [
                0.9999310970306396,
                2.7534553737496026e-05,
                4.784787961398251e-06,
                3.7263964713929454e-06,
                3.2885332075238694e-06,
                2.902120741055114e-06,
                1.994596459553577e-06,
                1.2878081179223955e-06,
                1.2097838180125109e-06,
                1.1364867305019288e-06
              ]
            ],
            "top10_tokens_snapshots": [
              {
                "step": 0,
                "tokens": [
                  {
                    "token": "17",
                    "prob": 0.9999356269836426,
                    "idx": 1114
                  },
                  {
                    "token": "7",
                    "prob": 2.753467924776487e-05,
                    "idx": 22
                  },
                  {
                    "token": "16",
                    "prob": 4.222579264023807e-06,
                    "idx": 845
                  },
                  {
                    "token": "017",
                    "prob": 3.2885482141864486e-06,
                    "idx": 17248
                  },
                  {
                    "token": "11",
                    "prob": 3.2885482141864486e-06,
                    "idx": 806
                  },
                  {
                    "token": "117",
                    "prob": 2.56112389251939e-06,
                    "idx": 8546
                  },
                  {
                    "token": "19",
                    "prob": 1.7602329762667068e-06,
                    "idx": 777
                  },
                  {
                    "token": "12",
                    "prob": 1.0676352530936128e-06,
                    "idx": 717
                  },
                  {
                    "token": "15",
                    "prob": 1.0676352530936128e-06,
                    "idx": 868
                  },
                  {
                    "token": "1",
                    "prob": 1.0029505119746318e-06,
                    "idx": 16
                  }
                ]
              },
              {
                "step": 4,
                "tokens": [
                  {
                    "token": "17",
                    "prob": 0.9999310970306396,
                    "idx": 1114
                  },
                  {
                    "token": "7",
                    "prob": 2.7534553737496026e-05,
                    "idx": 22
                  },
                  {
                    "token": "16",
                    "prob": 4.784787961398251e-06,
                    "idx": 845
                  },
                  {
                    "token": "11",
                    "prob": 3.7263964713929454e-06,
                    "idx": 806
                  },
                  {
                    "token": "017",
                    "prob": 3.2885332075238694e-06,
                    "idx": 17248
                  },
                  {
                    "token": "117",
                    "prob": 2.902120741055114e-06,
                    "idx": 8546
                  },
                  {
                    "token": "19",
                    "prob": 1.994596459553577e-06,
                    "idx": 777
                  },
                  {
                    "token": "12",
                    "prob": 1.2878081179223955e-06,
                    "idx": 717
                  },
                  {
                    "token": "15",
                    "prob": 1.2097838180125109e-06,
                    "idx": 868
                  },
                  {
                    "token": "1",
                    "prob": 1.1364867305019288e-06,
                    "idx": 16
                  }
                ]
              }
            ],
            "health_status": [
              "OK",
              "OK",
              "OK",
              "OK",
              "OK"
            ]
          }
        }
      ]
    },
    {
      "question": "What is the sum of 34 and 12?",
      "answer": 46,
      "tokens": [
        {
          "position": 0,
          "target": 2790,
          "target_token": "46",
          "pred_before": "46",
          "pred_after": "46",
          "correct_before": true,
          "correct_after": true,
          "metrics": {
            "nae": [
              0.014325601048767567,
              0.014347226358950138,
              0.014329868368804455,
              0.014352535828948021,
              0.014323132112622261,
              0.0
            ],
            "target_prob": [
              0.999835729598999,
              0.9998160004615784,
              0.9998319149017334,
              0.9998107552528381,
              0.9998379945755005,
              0.9998308420181274
            ],
            "target_rank": [
              1,
              1,
              1,
              1,
              1,
              1
            ],
            "top10_probs": [
              [
                0.999835729598999,
                2.429683991067577e-05,
                1.4736777302459814e-05,
                1.3005161235923879e-05,
                1.1477014595584478e-05,
                8.938308383221738e-06,
                7.88802844908787e-06,
                6.1432033362507354e-06,
                6.1432033362507354e-06,
                6.1432033362507354e-06
              ],
              [
                0.9998160004615784,
                2.7531383238965645e-05,
                1.4736486264155246e-05,
                1.4736486264155246e-05,
                1.3004903848923277e-05,
                1.0128228495887015e-05,
                8.938131031754892e-06,
                6.961023700569058e-06,
                6.961023700569058e-06,
                6.143081918708049e-06
              ],
              [
                0.9998319149017334,
                2.429674714221619e-05,
                1.4736720913788304e-05,
                1.3005112123209983e-05,
                1.1476970939838793e-05,
                8.93827382242307e-06,
                7.887998435762711e-06,
                6.961134658922674e-06,
                6.143179689388489e-06,
                6.143179689388489e-06
              ],
              [
                0.9998107552528381,
                3.11969815811608e-05,
                1.6698539184289984e-05,
                1.4736408957105596e-05,
                1.3004835636820644e-05,
                1.0128175745194312e-05,
                8.938084647525102e-06,
                6.960986866033636e-06,
                6.960986866033636e-06,
                6.143049631646136e-06
              ],
              [
                0.9998379945755005,
                2.4296894480357878e-05,
                1.473681095376378e-05,
                1.3005190339754336e-05,
                1.147704097093083e-05,
                8.938328392105177e-06,
                7.888046638981905e-06,
                6.143216978671262e-06,
                6.143216978671262e-06,
                5.421370133262826e-06
              ]
            ],
            "top10_tokens_snapshots": [
              {
                "step": 0,
                "tokens": [
                  {
                    "token": "46",
                    "prob": 0.999835729598999,
                    "idx": 2790
                  },
                  {
                    "token": "47",
                    "prob": 2.429683991067577e-05,
                    "idx": 2618
                  },
                  {
                    "token": "48",
                    "prob": 1.4736777302459814e-05,
                    "idx": 2166
                  },
                  {
                    "token": "146",
                    "prob": 1.3005161235923879e-05,
                    "idx": 10465
                  },
                  {
                    "token": "45",
                    "prob": 1.1477014595584478e-05,
                    "idx": 1774
                  },
                  {
                    "token": "4",
                    "prob": 8.938308383221738e-06,
                    "idx": 19
                  },
                  {
                    "token": "40",
                    "prob": 7.88802844908787e-06,
                    "idx": 1272
                  },
                  {
                    "token": "36",
                    "prob": 6.1432033362507354e-06,
                    "idx": 1927
                  },
                  {
                    "token": "26",
                    "prob": 6.1432033362507354e-06,
                    "idx": 1627
                  },
                  {
                    "token": "16",
                    "prob": 6.1432033362507354e-06,
                    "idx": 845
                  }
                ]
              },
              {
                "step": 4,
                "tokens": [
                  {
                    "token": "46",
                    "prob": 0.9998379945755005,
                    "idx": 2790
                  },
                  {
                    "token": "47",
                    "prob": 2.4296894480357878e-05,
                    "idx": 2618
                  },
                  {
                    "token": "48",
                    "prob": 1.473681095376378e-05,
                    "idx": 2166
                  },
                  {
                    "token": "146",
                    "prob": 1.3005190339754336e-05,
                    "idx": 10465
                  },
                  {
                    "token": "45",
                    "prob": 1.147704097093083e-05,
                    "idx": 1774
                  },
                  {
                    "token": "4",
                    "prob": 8.938328392105177e-06,
                    "idx": 19
                  },
                  {
                    "token": "40",
                    "prob": 7.888046638981905e-06,
                    "idx": 1272
                  },
                  {
                    "token": "16",
                    "prob": 6.143216978671262e-06,
                    "idx": 845
                  },
                  {
                    "token": "36",
                    "prob": 6.143216978671262e-06,
                    "idx": 1927
                  },
                  {
                    "token": "26",
                    "prob": 5.421370133262826e-06,
                    "idx": 1627
                  }
                ]
              }
            ],
            "health_status": [
              "OK",
              "OK",
              "OK",
              "OK",
              "OK"
            ]
          }
        }
      ]
    }
  ],
  "flipped_cases": []
}