{
  "common": {
    "data_path": "../data/addition_problems_dataset(1-50)(1).json",
    "num_samples": 50,
    "update_target": "mlp+ln",
    "num_layers": "all",
    "layer_stride": 1,
    "steps": 30,
    "lr": 0.001,
    "optimizer": "sgd",
    "momentum": 0.9,
    "weight_decay": 0.0,
    "scheduler": "none",
    "grad_clip": 1.0,
    "max_grad_norm": 1000000.0,
    "early_stop": false,
    "patience": 0,
    "fast_eval": false,
    "skip_if_correct": false,
    "reset_mode": "per_token",
    "tracked_topk": 10,
    "num_topk": 10,
    "snapshot_steps": "auto",
    "loss_float32": true,
    "loss_eps": 0.0001,
    "no_embed_cache": false,
    "allow_prefix_space": false,
    "gradient_checkpointing": false,
    "empty_cache_each": false,
    "eval_ar": true,
    "eval_ar_tta": true,
    "topk_list": "1,5,10",
    "dtype": "bf16",
    "device_map": "auto",
    "seed": 42,
    "output_dir": "main"
  },
  "experiments": [
    {
      "exp_name": "llama1b_steps5",
      "model": "/home/jinsk/Models/Llama-3.2-1B-Instruct",
      "steps": 5
    },
    {
      "exp_name": "llama1b_steps30",
      "model": "/home/jinsk/Models/Llama-3.2-1B-Instruct",
      "steps": 30
    },
    {
      "exp_name": "llama3b_steps5",
      "model": "/home/jinsk/Models/Llama-3.2-3B-Instruct",
      "steps": 5
    },
    {
      "exp_name": "llama3b_steps30",
      "model": "/home/jinsk/Models/Llama-3.2-3B-Instruct",
      "steps": 30
    },
    {
      "exp_name": "llama8b_steps5",
      "model": "/home/jinsk/Models/Llama-3.1-8B-Instruct",
      "steps": 5,
      "layer_stride": 2,
      "reset_mode": "per_sample",
      "gradient_checkpointing": true
    },
    {
      "exp_name": "llama8b_steps30",
      "model": "/home/jinsk/Models/Llama-3.1-8B-Instruct",
      "steps": 30,
      "layer_stride": 2,
      "reset_mode": "per_sample",
      "gradient_checkpointing": true,
      "early_stop": true,
      "patience": 3
    }
  ]
}
