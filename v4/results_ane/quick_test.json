{
  "summary": {
    "model": "Llama-3.2-3B-Instruct",
    "accuracy_before": 1.0,
    "accuracy_after": 1.0,
    "improvement": 0.0,
    "total_tokens": 2,
    "flipped_count": 0,
    "elapsed_time_min": 0.25004400809605914,
    "config": {
      "update_target": "mlp+ln",
      "num_layers": "all",
      "steps": 5,
      "lr": 0.001
    }
  },
  "results": [
    {
      "question": "What is the sum of 9 and 8?",
      "answer": 17,
      "tokens": [
        {
          "position": 0,
          "target": 1114,
          "target_token": "17",
          "pred_before": "17",
          "pred_after": "17",
          "correct_before": true,
          "correct_after": true,
          "metrics": {
            "ane": [
              0.014209581539034843,
              0.014206180348992348,
              0.014216666109859943,
              0.01421237364411354,
              0.014203784056007862,
              0.0
            ],
            "target_prob": [
              0.9999356269836426,
              0.9999386072158813,
              0.9999288320541382,
              0.9999321699142456,
              0.9999409914016724,
              0.9999496936798096
            ],
            "target_rank": [
              1,
              1,
              1,
              1,
              1,
              1
            ],
            "top10_probs": [
              [
                0.9999356269836426,
                2.753467924776487e-05,
                4.222579264023807e-06,
                3.2885482141864486e-06,
                3.2885482141864486e-06,
                2.56112389251939e-06,
                1.7602329762667068e-06,
                1.0676352530936128e-06,
                1.0676352530936128e-06,
                1.0029505119746318e-06
              ],
              [
                0.9999386072158813,
                2.4299339202116244e-05,
                4.222591996949632e-06,
                3.2885579912544927e-06,
                3.2885579912544927e-06,
                2.56113139585068e-06,
                1.760238205861242e-06,
                1.136495257014758e-06,
                1.067638436325069e-06,
                1.067638436325069e-06
              ],
              [
                0.9999288320541382,
                3.120066685369238e-05,
                4.222550614940701e-06,
                3.726388058566954e-06,
                3.288525931566255e-06,
                2.9021141472185263e-06,
                1.994591912080068e-06,
                1.2097810895284056e-06,
                1.136484229391499e-06,
                1.0676280908228364e-06
              ],
              [
                0.9999321699142456,
                2.7534582841326483e-05,
                4.784792963619111e-06,
                3.2885368455026764e-06,
                3.2885368455026764e-06,
                2.902123696912895e-06,
                1.994598505916656e-06,
                1.2097850685677258e-06,
                1.1364879810571438e-06,
                1.1364879810571438e-06
              ],
              [
                0.9999409914016724,
                2.4299397409777157e-05,
                3.726433305928367e-06,
                3.288565949333133e-06,
                2.90214939013822e-06,
                2.561137534939917e-06,
                1.7602424122742377e-06,
                1.0029558552560047e-06,
                1.0029558552560047e-06,
                9.421898994332878e-07
              ]
            ],
            "top10_snapshots": [
              {
                "step": 0,
                "tokens": [
                  {
                    "token": "17",
                    "prob": 0.9999356269836426,
                    "idx": 1114
                  },
                  {
                    "token": "7",
                    "prob": 2.753467924776487e-05,
                    "idx": 22
                  },
                  {
                    "token": "16",
                    "prob": 4.222579264023807e-06,
                    "idx": 845
                  },
                  {
                    "token": "017",
                    "prob": 3.2885482141864486e-06,
                    "idx": 17248
                  },
                  {
                    "token": "11",
                    "prob": 3.2885482141864486e-06,
                    "idx": 806
                  },
                  {
                    "token": "117",
                    "prob": 2.56112389251939e-06,
                    "idx": 8546
                  },
                  {
                    "token": "19",
                    "prob": 1.7602329762667068e-06,
                    "idx": 777
                  },
                  {
                    "token": "12",
                    "prob": 1.0676352530936128e-06,
                    "idx": 717
                  },
                  {
                    "token": "15",
                    "prob": 1.0676352530936128e-06,
                    "idx": 868
                  },
                  {
                    "token": "1",
                    "prob": 1.0029505119746318e-06,
                    "idx": 16
                  }
                ]
              },
              {
                "step": 4,
                "tokens": [
                  {
                    "token": "17",
                    "prob": 0.9999409914016724,
                    "idx": 1114
                  },
                  {
                    "token": "7",
                    "prob": 2.4299397409777157e-05,
                    "idx": 22
                  },
                  {
                    "token": "16",
                    "prob": 3.726433305928367e-06,
                    "idx": 845
                  },
                  {
                    "token": "017",
                    "prob": 3.288565949333133e-06,
                    "idx": 17248
                  },
                  {
                    "token": "11",
                    "prob": 2.90214939013822e-06,
                    "idx": 806
                  },
                  {
                    "token": "117",
                    "prob": 2.561137534939917e-06,
                    "idx": 8546
                  },
                  {
                    "token": "19",
                    "prob": 1.7602424122742377e-06,
                    "idx": 777
                  },
                  {
                    "token": "12",
                    "prob": 1.0029558552560047e-06,
                    "idx": 717
                  },
                  {
                    "token": "15",
                    "prob": 1.0029558552560047e-06,
                    "idx": 868
                  },
                  {
                    "token": "1",
                    "prob": 9.421898994332878e-07,
                    "idx": 16
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    {
      "question": "What is the sum of 34 and 12?",
      "answer": 46,
      "tokens": [
        {
          "position": 0,
          "target": 2790,
          "target_token": "46",
          "pred_before": "46",
          "pred_after": "46",
          "correct_before": true,
          "correct_after": true,
          "metrics": {
            "ane": [
              0.014325601048767567,
              0.014324077405035496,
              0.014302985742688179,
              0.014312666840851307,
              0.01427244022488594,
              0.0
            ],
            "target_prob": [
              0.999835729598999,
              0.9998372793197632,
              0.9998561143875122,
              0.9998475313186646,
              0.9998838901519775,
              0.9998800754547119
            ],
            "target_rank": [
              1,
              1,
              1,
              1,
              1,
              1
            ],
            "top10_probs": [
              [
                0.999835729598999,
                2.429683991067577e-05,
                1.4736777302459814e-05,
                1.3005161235923879e-05,
                1.1477014595584478e-05,
                8.938308383221738e-06,
                7.88802844908787e-06,
                6.1432033362507354e-06,
                6.1432033362507354e-06,
                6.1432033362507354e-06
              ],
              [
                0.9998372793197632,
                2.4296876290463842e-05,
                1.4736800039827358e-05,
                1.3005181244807318e-05,
                1.1477032785478514e-05,
                8.938322025642265e-06,
                7.888041182013694e-06,
                6.143212885945104e-06,
                6.143212885945104e-06,
                5.421366040536668e-06
              ],
              [
                0.9998561143875122,
                2.1442323486553505e-05,
                1.3005425898882095e-05,
                1.1477248335722834e-05,
                1.012863594951341e-05,
                7.888189429650083e-06,
                6.961302915442502e-06,
                5.421468358690618e-06,
                5.421468358690618e-06,
                4.784429165738402e-06
              ],
              [
                0.9998475313186646,
                2.4297125492012128e-05,
                1.3005314940528478e-05,
                1.1477150110295042e-05,
                1.1477150110295042e-05,
                7.888122127042152e-06,
                7.888122127042152e-06,
                6.143275641079526e-06,
                6.143275641079526e-06,
                5.421421519713476e-06
              ],
              [
                0.9998838901519775,
                1.892330874397885e-05,
                1.0128916983376257e-05,
                8.938738574215677e-06,
                7.88840861787321e-06,
                6.143498922028812e-06,
                6.143498922028812e-06,
                4.784561951964861e-06,
                4.222360985295381e-06,
                4.222360985295381e-06
              ]
            ],
            "top10_snapshots": [
              {
                "step": 0,
                "tokens": [
                  {
                    "token": "46",
                    "prob": 0.999835729598999,
                    "idx": 2790
                  },
                  {
                    "token": "47",
                    "prob": 2.429683991067577e-05,
                    "idx": 2618
                  },
                  {
                    "token": "48",
                    "prob": 1.4736777302459814e-05,
                    "idx": 2166
                  },
                  {
                    "token": "146",
                    "prob": 1.3005161235923879e-05,
                    "idx": 10465
                  },
                  {
                    "token": "45",
                    "prob": 1.1477014595584478e-05,
                    "idx": 1774
                  },
                  {
                    "token": "4",
                    "prob": 8.938308383221738e-06,
                    "idx": 19
                  },
                  {
                    "token": "40",
                    "prob": 7.88802844908787e-06,
                    "idx": 1272
                  },
                  {
                    "token": "36",
                    "prob": 6.1432033362507354e-06,
                    "idx": 1927
                  },
                  {
                    "token": "26",
                    "prob": 6.1432033362507354e-06,
                    "idx": 1627
                  },
                  {
                    "token": "16",
                    "prob": 6.1432033362507354e-06,
                    "idx": 845
                  }
                ]
              },
              {
                "step": 4,
                "tokens": [
                  {
                    "token": "46",
                    "prob": 0.9998838901519775,
                    "idx": 2790
                  },
                  {
                    "token": "47",
                    "prob": 1.892330874397885e-05,
                    "idx": 2618
                  },
                  {
                    "token": "48",
                    "prob": 1.0128916983376257e-05,
                    "idx": 2166
                  },
                  {
                    "token": "146",
                    "prob": 8.938738574215677e-06,
                    "idx": 10465
                  },
                  {
                    "token": "45",
                    "prob": 7.88840861787321e-06,
                    "idx": 1774
                  },
                  {
                    "token": "40",
                    "prob": 6.143498922028812e-06,
                    "idx": 1272
                  },
                  {
                    "token": "4",
                    "prob": 6.143498922028812e-06,
                    "idx": 19
                  },
                  {
                    "token": "36",
                    "prob": 4.784561951964861e-06,
                    "idx": 1927
                  },
                  {
                    "token": "16",
                    "prob": 4.222360985295381e-06,
                    "idx": 845
                  },
                  {
                    "token": "26",
                    "prob": 4.222360985295381e-06,
                    "idx": 1627
                  }
                ]
              }
            ]
          }
        }
      ]
    }
  ],
  "flipped_cases": []
}